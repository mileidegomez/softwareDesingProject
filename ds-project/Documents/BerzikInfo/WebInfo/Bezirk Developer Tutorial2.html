<!DOCTYPE html>
<html lang="en-US">

<head><script type="text/javascript" src="/static/js/analytics.js?v=1511825011.0" charset="utf-8"></script>

<script type="text/javascript">archive_analytics.values.service='wb';archive_analytics.values.server_name='wwwb-app16.us.archive.org';archive_analytics.values.server_ms=534;</script><script type="text/javascript" src="/static/js/wbhack.js?v=1511825011.0" charset="utf-8"></script>

<script type="text/javascript">
__wbhack.init('https://web.archive.org/web');
</script>
<link rel="stylesheet" type="text/css" href="/static/css/banner-styles.css?v=1511825011.0" />
<link rel="stylesheet" type="text/css" href="/static/css/iconochive.css?v=1511825011.0" />

<!-- End Wayback Rewrite JS Include -->
    <!-- <meta http-equiv="refresh" content="100" > -->

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="/web/20170226213633im_/http://developer.bezirk.com:80/images/favicon.ico">

    <title>Bezirk Developer</title>

    <link href="/web/20170226213633cs_/http://developer.bezirk.com:80/css/bootstrap_bezirk.css" rel="stylesheet">

    <!-- Google material design icons -->
    <link href="https://web.archive.org/web/20170226213633cs_/https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- Syntax highlighting -->
    <link href="/web/20170226213633cs_/http://developer.bezirk.com:80/css/syntax_highlighting/atelier-forest-light_kevin.css" rel="stylesheet">

    <script src="/web/20170226213633js_/http://developer.bezirk.com:80/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="https://web.archive.org/web/20170226213633js_/https://ajax.googleapis.com/ajax/libs/jquery/1.12.3/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.12.3.min.js"><\/script>')</script>

</head>

<body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script type="text/javascript" src="/static/js/timestamp.js?v=1511825011.0" charset="utf-8"></script>
<script type="text/javascript" src="/static/js/graph-calc.js?v=1511825011.0" charset="utf-8"></script>
<script type="text/javascript" src="/static/js/auto-complete.js?v=1511825011.0" charset="utf-8"></script>
<script type="text/javascript" src="/static/js/toolbar.js?v=1511825011.0" charset="utf-8"></script>

<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  /*min-width:800px !important;*/
}
.wb-autocomplete-suggestions {
    text-align: left; cursor: default; border: 1px solid #ccc; border-top: 0; background: #fff; box-shadow: -1px 1px 3px rgba(0,0,0,.1);
    position: absolute; display: none; z-index: 2147483647; max-height: 254px; overflow: hidden; overflow-y: auto; box-sizing: border-box;
}
.wb-autocomplete-suggestion { position: relative; padding: 0 .6em; line-height: 23px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 1.02em; color: #333; }
.wb-autocomplete-suggestion b { font-weight: bold; }
.wb-autocomplete-suggestion.selected { background: #f0f0f0; }
</style>
<div id="wm-ipp" lang="en" style="display:none;direction:ltr;">
<div style="position:fixed;left:0;top:0;right:0;">
<div id="wm-ipp-inside">
  <div style="position:relative;">
    <div id="wm-logo" style="float:left;width:130px;padding-top:10px;">
      <a href="/web/" title="Wayback Machine home page"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0" /></a>
    </div>
    <div class="r" style="float:right;">
      <div id="wm-btns" style="text-align:right;height:25px;">
                  <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a href="#"
             onclick="__wm.saveSnapshot('http://developer.bezirk.com:80/documentation/T2_pub_sub.php', '20170226213633')"
             title="Save to My Web Archive"
             id="wm-save-snapshot-open"
          >
            <span class="iconochive-web"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web"></span>
        	<a href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
	<a id="wm-tb-close" href="#close" onclick="__wm.h(event);return false;" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" style="text-align:right;">
	<a href="#" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=https://web.archive.org/web/20170226213633/http://developer.bezirk.com:80/documentation/T2_pub_sub.php', '', 'height=400,width=600'); return false;" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
	<a href="#" onclick="window.open('https://twitter.com/intent/tweet?text=https://web.archive.org/web/20170226213633/http://developer.bezirk.com:80/documentation/T2_pub_sub.php&amp;via=internetarchive', '', 'height=400,width=600'); return false;" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
    </div>
    <table class="c" style="">
      <tbody>
	<tr>
	  <td class="u" colspan="2">
	    <form target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://developer.bezirk.com:80/documentation/T2_pub_sub.php" onfocus="this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20170226213633" /><input type="submit" value="Go" /></form>
	  </td>
	  <td class="n" rowspan="2" style="width:110px;">
	    <table>
	      <tbody>
		<!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
		<tr class="m">
		  <td class="b" nowrap="nowrap">Jan</td>
		  <td class="c" id="displayMonthEl" title="You are here: 21:36:33 Feb 26, 2017">FEB</td>
		  <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20170505062009/http://developer.bezirk.com:80/documentation/T2_pub_sub.php" title="05 May 2017"><strong>May</strong></a></td>
		</tr>
		<!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
		<tr class="d">
		  <td class="b" nowrap="nowrap"><img src="/static/images/toolbar/wm_tb_prv_off.png" alt="Previous capture" width="14" height="16" border="0" /></td>
		  <td class="c" id="displayDayEl" style="width:34px;font-size:24px;white-space:nowrap;" title="You are here: 21:36:33 Feb 26, 2017">26</td>
		  <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20170505062009/http://developer.bezirk.com:80/documentation/T2_pub_sub.php" title="06:20:09 May 05, 2017"><img src="/static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0" /></a></td>
		</tr>
		<!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
		<tr class="y">
		  <td class="b" nowrap="nowrap">2016</td>
		  <td class="c" id="displayYearEl" title="You are here: 21:36:33 Feb 26, 2017">2017</td>
		  <td class="f" nowrap="nowrap">2018</td>
		</tr>
	      </tbody>
	    </table>
	  </td>
	</tr>
	<tr>
	  <td class="s">
	    	    <div id="wm-nav-captures">
	      	      <a class="t" href="/web/20170226213633*/http://developer.bezirk.com:80/documentation/T2_pub_sub.php" title="See a list of every capture for this URL">2 captures</a>
	      <div class="r" title="Timespan for captures of this URL">26 Feb 2017 - 05 May 2017</div>
	      </div>
	  </td>
	  <td class="k">
	    <a href="" id="wm-graph-anchor">
	      <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
		<canvas id="wm-sparkline-canvas" width="550" height="27" border="0"></canvas>
	      </div>
	    </a>
	  </td>
	</tr>
      </tbody>
    </table>
    <div style="position:absolute;bottom:0;right:2px;text-align:right;">
      <a id="wm-expand" class="wm-btn wm-closed" href="#expand" onclick="__wm.ex(event);return false;"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span style="font-size:80%">About this capture</span></a>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
            <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/alexacrawls);"></span>
		Organization: <a style="color:#33f;" href="https://archive.org/details/alexacrawls" target="_new"><span class="wm-title">Alexa Crawls</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Starting in 1996, <a href="http://www.alexa.com/">Alexa Internet</a> has been donating their crawl data to the Internet Archive.  Flowing in every day, these data are added to the <a href="http://web.archive.org/">Wayback Machine</a> after an embargo period.
	</div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/alexacrawls)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/alexacrawls" target="_new"><span class="wm-title">Alexa Crawls</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Starting in 1996, <a href="http://www.alexa.com/">Alexa Internet</a> has been donating their crawl data to the Internet Archive.  Flowing in every day, these data are added to the <a href="http://web.archive.org/">Wayback Machine</a> after an embargo period.
	</div>
	      </div>
    </div>
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="/static/images/loading.gif" alt="loading" /></div>
    </div>
  </div></div></div></div><script type="text/javascript">
__wm.bt(550,27,25,2,"web","http://developer.bezirk.com:80/documentation/T2_pub_sub.php","2017-02-26",1996);
</script>
<!-- END WAYBACK TOOLBAR INSERT -->
    <section class="major_light" style="position:fixed;">
        <div class="section-content nav">
            <!-- =============== NAVIGATION ======================================================== -->
            <nav class="navbar">
                <a style="color:#555;font-size:13.5pt;padding-right:20px;text-decoration:none;" href="/web/20170226213633/http://developer.bezirk.com:80/"><b>Bezirk</b> Developer</a>
                <ul id="nav">
                    <li class="active"><a href="/web/20170226213633/http://developer.bezirk.com:80/documentation/intro.php">Getting Started</a></li>
                    <li><a href="/web/20170226213633/http://developer.bezirk.com:80/javadocs.php">Javadocs</a></li>
                     <li><a href="/web/20170226213633/http://developer.bezirk.com:80/contact.php">Contact</a></li> 

                </ul>
            </nav>
         </div>
    </section>

    <div class="spacer-for-nav"></div>
    


    <style type="text/css">
        b {
            color:#555;
        }
        td {
            padding:15px;
            border:1px solid #DDD;
            vertical-align:top;
        }

        H4 {
            color:#555;
            font-size:14pt;
            font-weight:normal;
            margin:0;
            padding:0;
            padding-bottom:12px;
        }
        H3 {
            padding:0;
            padding-bottom:15px;
            margin:0;
            font-weight:normal;
            font-size:17pt;
            color:gray;
        }
        H2 {
            padding:0;
            margin:0;
            font-size:20pt;
        }

        div.panel-heading {
            background-color:#68cb97 !important;
            text-align:center;
        }

        TH {
            text-align:center;
            border:1px solid #ddd;
            padding:10px;
            color:gray;
        }

        HR {
            padding:0;
            margin-top:17px;
            margin-bottom:17px;
            border-color: #DDD;
        }


        /*  For mobile devices (like iPhone 6s) with screen width less than 980px,
            need to not fix the position of sidebar so that when zooming on the phone, the
            side bar doesn't mess things up.
        */

        /* mobile devices */
        @media screen and (max-width:980px) {
            #doc-sidebar {
                float:left;
                vertical-align: top;
                padding-top:40px;
                height:900px;
                width:230px;
                text-align:left;
                margin:0;
                line-height:1.6;
            }
        }

        /* desktop */
        @media screen and (min-width:1000px) {
            #doc-sidebar {
                /*position:fixed;*/
                float:left;
                vertical-align: top;
                padding-top:40px;
                height:900px;
                width:230px;
                text-align:left;
                margin:0;
                line-height:1.6;

            }
        }

        .sidebar-header {
            font-size:11pt;
            color:gray;
            margin-left:6px;
        }

        #doc-content {
            margin-left:230px;
            padding-left:40px;
            padding-right:40px;
            padding-top:40px;
            padding-bottom:60px;
            vertical-align:top;
            border-left: 1px solid #DDD;
            min-height:800px;
            overflow:auto;
        }

        section {
            margin-bottom:65px;
        }

        a {
            color:#5588cc;
        }

        a.anchor {
            padding-top:10px;
            margin-top:-10px;
        }

        div#doc-sidebar > a {
            font-size:10.5pt;
            line-height:1.9;
            padding-top:3px;
            padding-bottom:3px;
            padding-left:6px;
            padding-right:6px;
        }

        div#doc-sidebar > a.active {
            /*border-top:1px solid #cdF;
            border-bottom:1px solid #cdF;*/
          
            /*border:1px solid #ccddee;
            border-radius:5px;*/
            /*background-color:#88aaFF;
            color:white;*/
            /*color:#6699ee;*/
            font-weight:bold;
        }

        div#doc-sidebar > a:hover {
            text-decoration:none;
            color:#6699FF
        }

        OL,UL {
            margin:0;
            padding-left:40px;
        }

        OL.steps > LI {
            margin-bottom:30px;

        }

        img.figure {
            margin-top:18px;
            /*margin-left:20px;*/
            margin-right:20px;
            margin-bottom:0px;
            box-shadow:4px 4px 12px #999;
            vertical-align: middle;
        }

        img.right_arrow {
            padding-left:15px;
            padding-right:15px;
            width:55px;
            height:20px;
            opacity:0.7;
            vertical-align: middle;
        }
        pre {
            padding:0;
            border-radius: 0px;
            margin-top:10px;
            margin-bottom:14px;
            /*margin-left:20px;*/
            border:0;

            font-size:10pt;

            /* wrapping */
            white-space: pre-wrap;       /* Since CSS 2.1 */
            white-space: -moz-pre-wrap;  /* Mozilla, since 1999 */
            white-space: -pre-wrap;      /* Opera 4-6 */
            white-space: -o-pre-wrap;    /* Opera 7 */
            word-wrap: break-word;       /* Internet Explorer 5.5+ */
        }

        pre.non-code {
            padding:10px;
            border-radius:5px;
            background-color:white;
            border:1px solid #ddd;
        }

        div.highlight {
            background-color:#FFFFDD;
        }

        div.note {
            margin-top:0px;
            padding:10px;
            font-size:10pt;
            border-radius:0px;
            background-color:#f7f7f7;
            border-left:5px solid #e2e2e2;
        }

        div.note_header {
            color:gray;
        }

        div.note.concept {
            background-color:#F4FBFE;
            border-left:5px solid #88CCFF;
        }
        div.note.concept > .concept_header {
            font-weight:bold;
            color: #4499EE;
            margin-bottom:3px;
        }

        div.note.tip {
            background-color:#F4FFf4;
            border-left:5px solid #99dd99;
        }
        div.note.tip > .tip_header {
            font-weight:bold;
            color: #55cc55;
            margin-bottom:3px;
        }


        em {
            font-style:normal;
            color:olive;
            /*font-family:;*/
        }

        code {
            border-left:5px solid #d7eAff;
            padding:12px !important;
        }

        a.btn-show-code  {
            text-decoration:none;
            display:inline-block;
            border:1px solid #77AAFF;
            padding:8px 12px 8px 12px;
            border-radius:6px;
            font-size:11pt;
            /*margin-left:20px;*/
        }

        .material-icons.inline {
            display:inline-block;
            vertical-align:middle;
            font-size:22px;
            margin-bottom:4px;
        }
        .material-icons.right-arrow {
            color:#ccc;
            font-size:28pt;
            font-weight:bold;
            padding-right:20px;
            vertical-align: middle;
        }

        /* QnA / FAQ / Troubleshooting  */
        div.QnA {
            padding-bottom:20px;
            padding-top:20px;
            padding:20px;
            border-radius:7px;
            background-color:#f3f3f3;
            margin-top:30px;
        }

        div.question {
            color:#555;
            font-weight:bold;
        }
        div.answer {
            padding-top:15px;
            margin-left:0px;
        }



    </style>


    <div class="section-content documentation">
        <div id="doc-sidebar">
            <div class="sidebar-header">What is Bezirk</div>

            <a href="intro.php">Introduction</a> <br>
            <a href="key_terms.php">Key Terms</a><br>

            <p></p>
            <div class="sidebar-header">Getting Started</div>
            <a href="installation.php">Installation</a> <br>
            <a href="api_and_usage.php">API and Usage</a> <br>

            <p></p>
           
            <div class="sidebar-header">Android Step-by-step Tutorials</div>

            <a href="project_setup_android.php">Tutorial 0 - Project Setup</a><br>
            <a href="T1_hello_world_android.php">Tutorial 1 - Hello World</a> <br>
            <a href="T2_pub_sub_android.php">Tutorial 2 - Pub-Sub</a><br> 
            <!-- <a style='color:#aaa;'  href="#">Tutorial 2 (Coming Soon)</a><BR> -->
            <p></p>

            <div class="sidebar-header">PC (Java) Step-by-step Tutorials</div>

            <a href="project_setup.php">Tutorial 0 - Project Setup</a><br>
            <a href="T1_hello_world.php">Tutorial 1 - Hello World</a> <br>
            <a class="active" href="T2_pub_sub.php">Tutorial 2 - Pub-Sub</a><br>
            
            <!--
                <a style='color:silver;pointer-events:none;'>Coming Soon:</a> <BR>
                <a style='color:silver;pointer-events:none;'  href="">Tutorial 3 - Recipient-Selection</a><BR>

                <a style='color:silver;pointer-events:none;'   href="">Tutorial 4 - Streaming</a><BR>

                <a style='color:silver;pointer-events:none;'   href="">Tutorial 5 - Spheres</a><BR>

                <a style='color:silver;pointer-events:none;'   href="">Tutorial 6 - Pipes</a><BR>
            -->
            <p></p>

            <div class="sidebar-header">Bezirk Ecosystem</div>
            <a href="ecosystem.php">Overview</a><br>
            <!-- <a  href='ecosystem.php?section=adapter_zirks#adapter_zirks'>Adapter Zirks</a><BR>
            <a  href='ecosystem.php?section=hardware_simulator#hardware_simulator'>Hardware Simulator</a><BR> -->



            <p></p>

            <div class="sidebar-header">Reference</div>
            <a href="FAQ.php">FAQ</a><br>
            <a href="troubleshooting.php">Troubleshooting</a><br>
            <a href="/web/20170226213633/http://developer.bezirk.com:80/javadocs.php">Javadocs</a>

            <p></p>


            <!--
            <div class='sidebar-header'>Event-Specific Info</div>
            <a  href="/documentation/CMU_hackathon_instructions.php">CMU Hackathon</a><BR>
            -->
            
        </div>

        <div id="doc-content">  <section>
    <h2>Tutorial 2: Publish-Subscribe</h2>
    <hr>
    <h3>Overview</h3>

    In this tutorial, you'll create two Zirks that interoperate - one Zirk will publish data, and the other will listen for, receive, and act upon that data. 
    To make the example more concrete, we'll use a real-world scenario as follows:<br>
    <p>
    <ul>
        <li>An Air Quality Sensor Zirk publishes data about house air quality, including humidity, dust level, and pollen level.
            (We can assume that it is able to get this data from arbitrary hardware sensors.)
        </li>
        <li>An Asthma Assistant Zirk subscribes to this data and uses it to provide interventions to the user. For example if there is a high pollen count, the Asthma Assistant Zirk can alert the user to turn on the air purifier.</li>
    </ul>
  </section>

  <section>
    <h3>Learning Objectives</h3>
    At the end of the tutorial, you'll be able to:
    <ul>
        <li>Be more experienced with creating and sending events</li>   
        <li>Have a Zirk subscribe to and receive events, and process them to do something useful.</li>
    </ul>
  </section>

  <section>
    <h3>Create a Custom Event for Air Quality Updates</h3>
    
    <ol class="steps">
        <li>Create a new Gradle project called <em>AirQualitySensorZirk</em>, and configure it to fetch the Bezirk API. (See <a href="project_setup.php">Project Setup</a> if needed. You can also use <a href="https://web.archive.org/web/20170226213633/https://github.com/kevinhhbosch/AirQualitySensorZirkEmpty/archive/master.zip" onclick="ga('send', 'event', 'Get Code', 'Click', 'Get Empty Project - AirQualitySensorZirk');">this empty project</a> if you'd like.)
        </li>

        <li>Create a new class under <em>src/main/java</em> folder called <em>AirQualityUpdateEvent</em> and extend the Event class.
            <pre><code class="java">import com.bezirk.middleware.messages.Event;
public class AirQualityUpdateEvent extends Event {
</code></pre>        </li>
        <li>Add the air quality variables: humidity, dustLevel and pollenLevel. If Android Studio complains that the variables have not been initialized, just continue to the next step.
            <pre><code class="java">private final double
    humidity /* decimal, e.g., 0.5 */,
    dustLevel /* milligrams per cubic meter. Above 20 is high. */,
    pollenLevel /* grams per cubic meter. Above 500 is high. */;
</code></pre>        </li>


        <li>Add a constructor to initialize these variables and getters to access them.
            <pre><code class="java">public AirQualityUpdateEvent(double humidity, double dustLevel, double pollenLevel) {
    this.humidity = humidity;
    this.dustLevel = dustLevel;
    this.pollenLevel = pollenLevel;
}

public double getHumidity() {
    return humidity;
}

public double getDustLevel() {
    return dustLevel;
}

public double getPollenLevel() {
    return pollenLevel;
}
</code></pre>

        </li>
        <li>
            Add a toString() method so we can see the output more easily later.
            <pre><code class="java">public String toString() {
    return String.format("humidity: %s, dustLevel: %s, pollenLevel: %s", 
        humidity, dustLevel, pollenLevel);
}
</code></pre>            <br>
            Click below to see the whole code. <p>
            <a class="btn-show-code" href="javascript:toggleElem(&quot;AQUpdateEvent_class&quot;);">Show AirQualityUpdateEvent.java</a>
            <div id="AQUpdateEvent_class" style="display:none;">
                <pre><code class="java">import com.bezirk.middleware.messages.Event;

public class AirQualityUpdateEvent extends Event {
    private final double
            humidity /* decimal, e.g., 0.5 */,
            dustLevel /* milligrams per cubic meter. Above 20 is high. */,
            pollenLevel /* grams per cubic meter. Above 500 is high. */;

    public AirQualityUpdateEvent(double humidity, double dustLevel, double pollenLevel) {
        this.humidity = humidity;
        this.dustLevel = dustLevel;
        this.pollenLevel = pollenLevel;
    }

    public double getHumidity() {
        return humidity;
    }

    public double getDustLevel() {
        return dustLevel;
    }

    public double getPollenLevel() {
        return pollenLevel;
    }

    public String toString() {
        return String.format("humidity: %s, dustLevel: %s, pollenLevel: %s", humidity,
                dustLevel, pollenLevel);
    }
}
</code></pre>            </div>
        </li>
    </ol>

    
  </section>

  <section>
    <h3>Have a Zirk Publish the Custom Event</h3>

    <ol class="steps">
        <li>
            Create a new class under <em>src/main/java</em> folder called <em>AirQualitySensorZirk</em>.
            Then import the Bezirk and BezirkMiddleware classes as usual, and declare a Bezirk field.
            <pre><code class="java">import com.bezirk.middleware.Bezirk;
import com.bezirk.middleware.java.proxy.BezirkMiddleware;

public class AirQualitySensorZirk {
    private Bezirk bezirk;
}
</code></pre>        </li>
        <li>
            Create a constructor where we'll initialize the middleware and get the Bezirk instance using BezirkMiddleware's <em>initialize()</em> and <em>registerZirk()</em> methods. Print out a little status message.
            <p></p>

            <pre><code class="java">public AirQualitySensorZirk () {
    BezirkMiddleware.initialize();
    bezirk = BezirkMiddleware.registerZirk("Air Quality Sensor Zirk");
    System.out.println("Got Bezirk instance");
}
</code></pre>            <!--
            <div class='note tip'>
                <div class='tip_header'><i class="material-icons inline">info_outline</i> Note</div>
                Next, we're going to send the airQualityUpdateEvent, but because it's going to happen very shortly after BezirkMiddleware.initialize() during runtime, we need to add a 2 second sleep as discussed in the previous tutorial. 
            </div>
            <pre><code class='java'>try { Thread.sleep(2000); }
catch (InterruptedException e) { e.printStackTrace(); }
</code></pre>            -->
        </li>

        <li>
            Create a method called <em>sendAirQualityUpdate()</em> and inside it, instantiate <em>AirQualityUpdateEvent</em> and send this event using Bezirk instance. Finally, print out a status message.

            <pre><code class="java">public void sendAirQualityUpdate() {
    final double humidity = 0.8;
    final int dustLevel = 30;
    final int pollenLevel = 1000;
    final AirQualityUpdateEvent airQualityUpdateEvent = new AirQualityUpdateEvent(humidity, dustLevel, pollenLevel);

    bezirk.sendEvent(airQualityUpdateEvent);

    System.out.println("Published air quality update: " + airQualityUpdateEvent.toString());
}
</code></pre>        </li>
        <li>
            Finally, create the main method  for this class.
            <pre><code class="java">public static void main (String args[]) {
    AirQualitySensorZirk airQualitySensorZirk = new AirQualitySensorZirk();
    airQualitySensorZirk.sendAirQualityUpdate();
}
</code></pre>
            Click below to see the whole code.<p>
            <a class="btn-show-code" href="javascript:toggleElem(&quot;AirQualitySensorZirk.java&quot;);">Show AirQualitySensorZirk.java</a>
            <div id="AirQualitySensorZirk.java" style="display:none;">
                <pre><code class="java">import com.bezirk.middleware.Bezirk;
import com.bezirk.middleware.java.proxy.BezirkMiddleware;

public class AirQualitySensorZirk {
    private Bezirk bezirk;
    public AirQualitySensorZirk () {

        BezirkMiddleware.initialize();
        bezirk = BezirkMiddleware.registerZirk("Air Quality Sensor Zirk");
        System.out.println("Got Bezirk instance");
    }

    public void sendAirQualityUpdate() {

        final double humidity = 0.8;
        final int dustLevel = 30;
        final int pollenLevel = 1000;
        final AirQualityUpdateEvent airQualityUpdateEvent = new AirQualityUpdateEvent(humidity, dustLevel, pollenLevel);

        bezirk.sendEvent(airQualityUpdateEvent);

        System.out.println("Published air quality update: " + airQualityUpdateEvent.toString());
    }

    public static void main (String args[]) {
        AirQualitySensorZirk airQualitySensorZirk = new AirQualitySensorZirk();
        airQualitySensorZirk.sendAirQualityUpdate();
    }
}
</code></pre>            </div>
        </li>


        <li>
            Run the code and you should able able to see the following output:<br>
            <pre class="non-code">Got Bezirk instance
Published air quality update: humidity: 0.8 dustLevel: 30.0 pollenLevel: 1000.0
</pre>        </li>
    </ol>

    <p>
  </section>
  <section>
    <h3>Create a Zirk to Receive Events by Subscribing</h3>

    Now we'll create the second Zirk, an Asthma Assistant Zirk, that receives and acts upon Air Quality Update Events.
    <p>
    We're going to use a new project to create this Zirk to show how disparate Zirks can reuse common events to interoperate. Let's begin!

    <h4>Create the AsthmaAssistantZirk project and add AirQualityUpdateEvent to it</h4>

    <ol>
        <li>
            Create a new Gradle project called <em>AsthmaAssistantZirk</em>, and configure it to fetch the Bezirk API in Android Studio.
            Again, feel free to refer to <a href="project_setup.php">Project Setup</a> to practice doing it yourself or download and import <a href="https://web.archive.org/web/20170226213633/https://github.com/kevinhhbosch/AsthmaAssistantZirkEmpty/archive/master.zip" onclick="ga('send', 'event', 'Get Code', 'Click', 'Get Empty Project - AsthmaAssistantZirk');">this empty project</a>.)
        </li><p>
        <li>
            Copy and paste the <em>AirQualityUpdateEvent.java</em> file from the previous project into the <em>java</em> folder of this project so that we can receive and use this event. (An alternative approach in the future is to create events in a separate project and compile them as a jar to be added as a library to projects that need them.) 
        </li><p>

        <div class="note tip">
            <div class="tip_header"><i class="material-icons inline">info_outline</i> Important Note</div>
            Events must be in the same package to be used between publishers and subscribers.                
        </div>

    </ol>
    <p></p>
    <h4>Create the AsthmaAssistantZirk class</h4>
    <ol class="steps">
        <li>
            Create a new class called <em>AsthmaAssistantZirk</em>, and create a constructor where BezirkMiddleware is initialized and Bezirk is instantiated just as before. Because we're not sending events very shortly after initializing, we don't need to worry about adding .sleep() statement here. Import classes as necessary.
            <pre><code class="java">import com.bezirk.middleware.Bezirk;
import com.bezirk.middleware.java.proxy.BezirkMiddleware;

public class AsthmaAssistantZirk {

    public AsthmaAssistantZirk() {
        BezirkMiddleware.initialize();
        final Bezirk bezirk = BezirkMiddleware.registerZirk("Asthma Assistant Zirk");
    }
}
</code></pre>        </li>
        
        <li>
            Create an <em>EventSet</em>, which is just a set of events - you can then subscribe to to this EventSet in order to receive the events. Here, we'll have a set of just one event, the Air Quality Update event. 
            <pre><code class="java">EventSet airQualityEvents = new EventSet(AirQualityUpdateEvent.class);
</code></pre>        </li>
        <li>
            Now we can attach a listener to the EventSet to do something useful when an event is received. To do that, we'll use EventSet's <em>setEventReceiver()</em> method as follows:
            <pre><code class="java">airQualityEvents.setEventReceiver(new EventSet.EventReceiver() {
    @Override
    public void receiveEvent(Event event, ZirkEndPoint sender) {
        //Check if this event is of interest
        if (event instanceof AirQualityUpdateEvent) {
            final AirQualityUpdateEvent aqUpdate = (AirQualityUpdateEvent) event;
            System.out.println("\nReceived air quality update: " + aqUpdate.toString());
            //do something in response to this event
            if (aqUpdate.getHumidity() &gt; 0.7) {
                System.out.println("Humidity is high - recommend turning on the dehumidifier.");
            }
            if (aqUpdate.getDustLevel() &gt; 20) {
                System.out.println("Dust level is high - recommend running the vacuum.");
            }
            if (aqUpdate.getPollenLevel() &gt; 500) {
                System.out.println("Pollen level is high - recommend closing the windows and running the air filter.");
            }
        }
    }
});
</code></pre>        </li>
        <li>
            Now that we've set up the event set, we can subscribe to it.
            <pre><code class="java">bezirk.subscribe(airQualityEvents);</code></pre>        </li>
        <li>
            Now let's just add a main method and we're done!
            <pre><code class="java">public static void main (String args[]) {
    AsthmaAssistantZirk asthmaAssistantZirk = new AsthmaAssistantZirk();
    System.out.println("Listening for air quality update events...");
}
</code></pre>            Click below to see the whole file.<p>
            <a class="btn-show-code" href="javascript:toggleElem(&quot;AsthmaAssistantZirk.java&quot;);">Show AsthmaAssistantZirk.java</a>
            <div id="AsthmaAssistantZirk.java" style="display:none;">
                <pre><code class="java">import com.bezirk.middleware.Bezirk;
import com.bezirk.middleware.addressing.ZirkEndPoint;
import com.bezirk.middleware.java.proxy.BezirkMiddleware;
import com.bezirk.middleware.messages.Event;
import com.bezirk.middleware.messages.EventSet;

public class AsthmaAssistantZirk {

    public AsthmaAssistantZirk() {
        BezirkMiddleware.initialize();
        final Bezirk bezirk = BezirkMiddleware.registerZirk("Asthma Assistant Zirk");

        EventSet airQualityEvents = new EventSet(AirQualityUpdateEvent.class);

        airQualityEvents.setEventReceiver(new EventSet.EventReceiver() {
            @Override
            public void receiveEvent(Event event, ZirkEndPoint sender) {
                //Check if this event is of interest
                if (event instanceof AirQualityUpdateEvent) {
                    final AirQualityUpdateEvent aqUpdate = (AirQualityUpdateEvent) event;
                    System.out.println("\nReceived air quality update: " + aqUpdate.toString());
                    //do something in response to this event
                    if (aqUpdate.getHumidity() &gt; 0.7) {
                        System.out.println("Humidity is high - recommend turning on the dehumidifier.");
                    }
                    if (aqUpdate.getDustLevel() &gt; 20) {
                        System.out.println("Dust level is high - recommend running the vacuum.");
                    }
                    if (aqUpdate.getPollenLevel() &gt; 500) {
                        System.out.println("Pollen level is high - recommend closing the windows and running the air filter.");
                    }
                }
            }
        });

        bezirk.subscribe(airQualityEvents);

    }

    public static void main (String args[]) {
        AsthmaAssistantZirk asthmaAssistantZirk = new AsthmaAssistantZirk();
        System.out.println("Listening for air quality update events...");
    }
}
</code></pre>            </div>
        </li>

    </ol>
    

  </section>

  <section>
    <h3>Run the example</h3>
    Now we can run our two Zirks and see them interoperate. <p>
    <ol class="steps">
        <li>
            First run the <em>AsthmaAssistantZirk</em> to have it start listening for air quality update events.
            You should see:
            <pre class="non-code">Listening for air quality update events...</pre>
        </li>
        <li>
            Next run the <em>AirQualitySensorZirk</em> to send the event. You should see:
            <pre class="non-code">Published air quality update: humidity: 0.8 dustLevel: 30.0 pollenLevel: 1000.0</pre>

        </li>

        <li>
            Finally, you should see the output from the <em>AsthmaAssistantZirk</em> in response to the event.
            <pre class="non-code">Received air quality update: humidity: 0.8 dustLevel: 30.0 pollenLevel: 1000.0
Humidity is high - recommend turning on the dehumidifier.
Dust level is high - recommend running the vacuum.
Pollen level is high - recommend closing the windows and running the air filter.
</pre>
        </li>


    <p>

  </section>

  <p>

            <div class="note tip">
                <div class="tip_header"><i class="material-icons inline">lightbulb_outline</i> Tip</div>
                Note that the 2nd parameter for <em>receiveEvent(Event event, ZirkEndPoint sender)</em> is a <em>ZirkEndPoint</em>. This is a handle to the sender of the event, and it provides a way to communicate with just this sender. Remember that pub-sub,
                the style of communication we've been using so far, is based on publications, which means that an event is broadcast to many Zirks simultaneously. ZirkEndPoints are used
                for one-on-one, or unicast, communications. 
                <p>
                To send an event to a ZirkEndPoint, simply add that as a parameter in Bezirk's <em>sendEvent()</em> method. For example, with the ZirkEndPoint called sender:
                <pre style="display:inline;">bezirk.sendEvent(sender, new SomeReplyEventForTheSender());</pre>
            </div>
            <p>


        <br><br>
        <div class="note"><div class="note_header">Note</div>
             Here are the completed Android Studio projects if you'd like to download them:<br>
             
             <a href="https://web.archive.org/web/20170226213633/https://github.com/Bezirk-Bosch/AirQualitySensorZirk/archive/master.zip" onclick="ga('send', 'event', 'Get Code', 'Click', 'Get Complete Project - AirQualitySensorZirk');"><i class="material-icons inline">file_download</i>AirQualitySensorZirk</a>  &nbsp;&nbsp;&nbsp;&nbsp;
             <a href="https://web.archive.org/web/20170226213633/https://github.com/Bezirk-Bosch/AsthmaAssistantZirk/archive/master.zip" onclick="ga('send', 'event', 'Get Code', 'Click', 'Get Complete Project - AsthmaAssistantZirk');"><i class="material-icons inline">file_download</i>AsthmaAssistantZirk</a>
        </div>

  
        </div> <!-- doc-content -->


    </div> <!-- section-content documentation -->



    <br>
    <footer>
        Copyright &copy; 2016 Bezirk &nbsp;&nbsp;&nbsp;&nbsp; <a href="/web/20170226213633/http://developer.bezirk.com:80/legal.php">Legal</a>
    </footer>

    <!-- JavaScript
    ================================================== -->
    <script>
        function toggleElem(elemID) {
            elem = document.getElementById(elemID);

            if (elem.style.display != "block") {
                elem.style.display = "block";
                elem.style.webkitAnimation = "fadeIn 0.5s";
                elem.style.animation = "fadeIn 0.5s";
            }
            else {
                elem.style.display = "none";
            }
        }

        <!------------------ GOOGLE ANALYTICS ----------------------->
        //This code prevents GA from registering views during development
        if (document.location.hostname.search("bezirk.com") !== -1) {
            
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://web.archive.org/web/20170226213633/https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-77058950-4', 'auto');
            ga('send', 'pageview');

        }

    </script>
</body>

</html>